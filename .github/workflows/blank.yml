name: CI

on:
  push:
  pull_request:

  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
          
      - run: |
          Invoke-WebRequest 'https://nodejs.org/download/release/v14.21.1/node-v14.21.1-win-x64.zip' -OutFile 'node-v14.21.1-win-x64.zip'
          New-Item 'C:\node' -itemType Directory
          Expand-Archive node-v14.21.1-win-x64.zip -DestinationPath c:\node
        shell: pwsh
        
      - run: |
          @echo on
          set "PATH=C:\node\node-v14.21.1-win-x64;%PATH%"
          setx PATH=C:\node\node-v14.21.1-win-x64;%PATH% /m
          echo %PATH%
          node --version
          npm --version
          npm install /g npm@9
          npm --version
        shell: cmd
        
      - run: |
          &c:\node\node-v14.21.1-win-x64\npm.cmd install --g npm
          &c:\node\node-v14.21.1-win-x64\npm.cmd --version
        shell: pwsh
        
      - run: |
          /node/node-v14.21.1-win-x64/npm.cmd install --g npm
          /node/node-v14.21.1-win-x64/npm.cmd --version
        shell: bash
        
